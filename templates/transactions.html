{% extends "base.html" %}

{% block title %}Transactions - Chengeta{% endblock %}

{% block content %}
<div class="transactions-page">
    <!-- Page Header -->
    <div class="page-header">
        <h1>Transactions</h1>
        <div class="header-actions">
            <button class="btn btn-primary" onclick="showAddTransactionModal('income')">+ Income</button>
            <button class="btn btn-danger" onclick="showAddTransactionModal('expense')">+ Expense</button>
        </div>
    </div>

    <!-- Filters -->
    <div class="filters-section">
        <div class="filter-group">
            <label for="start-date">From</label>
            <input type="date" id="start-date" class="filter-input">
        </div>
        <div class="filter-group">
            <label for="end-date">To</label>
            <input type="date" id="end-date" class="filter-input">
        </div>
        <button class="btn btn-secondary" onclick="applyFilters()">Filter</button>
        <button class="btn btn-secondary" onclick="clearFilters()">Clear</button>
        <button class="btn btn-secondary" onclick="exportCSV()">Export CSV</button>
    </div>

    <!-- Transactions Table -->
    <div class="transactions-table-container">
        <table class="transactions-table" id="all-transactions">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Date</th>
                    <th>Description</th>
                    <th>Category</th>
                    <th>Type</th>
                    <th>Amount</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="7" class="text-center">Loading transactions...</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Add Transaction Modal -->
<div id="add-transaction-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modal-title">Add Transaction</h2>
            <span class="close" onclick="closeModal()">&times;</span>
        </div>
        <form id="add-transaction-form">
            <div class="form-group">
                <label for="amount">Amount ($)</label>
                <input type="number" id="amount" name="amount" step="0.01" required placeholder="0.00">
            </div>
            <div class="form-group">
                <label for="category">Category</label>
                <input type="text" id="category" name="category" required placeholder="e.g., Food, Salary, Transport">
            </div>
            <div class="form-group">
                <label for="description">Description</label>
                <input type="text" id="description" name="description" required placeholder="Brief description">
            </div>
            <input type="hidden" id="transaction-type" name="type">
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                <button type="submit" class="btn btn-primary" id="submit-btn">Add Transaction</button>
            </div>
        </form>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="delete-modal" class="modal">
    <div class="modal-content modal-sm">
        <div class="modal-header">
            <h2>Confirm Delete</h2>
            <span class="close" onclick="closeDeleteModal()">&times;</span>
        </div>
        <p>Are you sure you want to delete this transaction?</p>
        <div class="modal-actions">
            <button type="button" class="btn btn-secondary" onclick="closeDeleteModal()">Cancel</button>
            <button type="button" class="btn btn-danger" onclick="confirmDelete()">Delete</button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/transactions.js') }}"></script>
{% endblock %}

