{% extends "base.html" %}

{% block title %}Course Management - Chengeta Academy{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/academy.css') }}">
{% endblock %}

{% block content %}
<div class="admin-page">
    <div class="admin-header">
        <h1>Course Management</h1>
        <a href="{{ url_for('academy.create_course') }}" class="btn-create">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
            Create Course
        </a>
    </div>

    <!-- Stats -->
    <div class="admin-stats">
        <div class="stat-card">
            <div class="stat-icon courses">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                </svg>
            </div>
            <div class="stat-info">
                <span class="stat-value">{{ courses|length }}</span>
                <span class="stat-label">Total Courses</span>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon students">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/>
                </svg>
            </div>
            <div class="stat-info">
                <span class="stat-value">{{ total_students }}</span>
                <span class="stat-label">Total Students</span>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon revenue">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2v20M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/>
                </svg>
            </div>
            <div class="stat-info">
                <span class="stat-value">${{ "%.2f"|format(total_revenue) }}</span>
                <span class="stat-label">Total Revenue</span>
            </div>
        </div>
    </div>

    <!-- Courses Table -->
    <div class="admin-table-container">
        <h2>Your Courses</h2>
        {% if courses %}
        <table class="admin-table">
            <thead>
                <tr>
                    <th>Course</th>
                    <th>Status</th>
                    <th>Students</th>
                    <th>Lessons</th>
                    <th>Price</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for course in courses %}
                <tr>
                    <td class="course-cell">
                        <div class="course-thumb">
                            {% if course.thumbnail %}
                            <img src="{{ course.thumbnail }}" alt="{{ course.title }}">
                            {% else %}
                            <div class="thumb-placeholder">{{ course.title[0] }}</div>
                            {% endif %}
                        </div>
                        <div class="course-info">
                            <strong>{{ course.title }}</strong>
                            <span class="category">{{ course.category|title }}</span>
                        </div>
                    </td>
                    <td>
                        <span class="status-badge {{ 'published' if course.is_published else 'draft' }}">
                            {{ 'Published' if course.is_published else 'Draft' }}
                        </span>
                    </td>
                    <td>{{ course.total_students }}</td>
                    <td>{{ course.get_total_lessons() }}</td>
                    <td>{{ '$' + "%.2f"|format(course.price) if course.price > 0 else 'Free' }}</td>
                    <td class="actions-cell">
                        <a href="{{ url_for('academy.edit_course', course_id=course.id) }}" class="action-btn edit" title="Edit">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/>
                            </svg>
                        </a>
                        <a href="{{ url_for('academy.manage_lessons', course_id=course.id) }}" class="action-btn lessons" title="Manage Lessons">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
                            </svg>
                        </a>
                        <a href="{{ url_for('academy.course_detail', slug=course.slug) }}" class="action-btn view" title="View" target="_blank">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>
                            </svg>
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div class="empty-state">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
            </svg>
            <h3>No courses yet</h3>
            <p>Create your first course to start teaching!</p>
            <a href="{{ url_for('academy.create_course') }}" class="btn-primary">Create Course</a>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}

